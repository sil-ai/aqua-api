{
  "pipeline": {
    "name": "word_alignment"
  },
  "description": "A pipeline that performs word alignment based on fast align and statistical matching algorithms to give alignment scores.",
  "transform": {
    "cmd": [
      "python3",
      "pachyderm.py",
      "--source_dir",
      "/pfs/create_source_cache",
      "--target_dir",
      "/pfs/create_target_cache",
      "--outpath",
      "/pfs/out/",
      "--config-dir",
      "/pfs/target_config",
      "--is-bible"
    ],
    "image": "woodwardmw/<imagename>:<tag>"
  },
  "input": {
    "cross": [
      {
        "join": [
          {
            "pfs": {
              "repo": "create_source_cache",
              "glob": "/(*)/",
              "join_on": "$1",
              "outer_join": true
            }
          },
          {
            "pfs": {
              "repo": "refs",
              "glob": "(*)_all_ref_word_scores.csv/",
              "join_on": "$1",
              "group_by": "$1"
            }
          },
          {
            "pfs": {
              "repo": "refs",
              "glob": "(*)_all_ref_verse_scores.csv/",
              "join_on": "$1",
              "group_by": "$1"
            }
          }
        ]
      },
      {
        "join": [
          {
            "pfs": {
              "repo": "create_target_cache",
              "glob": "/(*)/",
              "join_on": "$1"
            }
          },
          {
            "pfs": {
              "repo": "target_config",
              "glob": "/(*)-config.json/",
              "join_on": "$1"
            }
          }
        ]
      }
    ]
  }
}